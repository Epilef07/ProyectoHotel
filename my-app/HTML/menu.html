<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MENU</title>
    <link rel="shortcut icon" href="/IMAGENES/iconSena.png">
    <link rel="stylesheet" href="/CSS/menu.css">
</head>
<body class="light-mode">
    <!--todo este es el encabezado -->
    <div class="app-container">
        <div class="app-header">
            <div class="app-header-left">
                <button class="navbar-toggle" id="navbar-toggle" title="Toggle Navbar">
                    <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
                <a href="https://oferta.senasofiaplus.edu.co/sofia-oferta/" target="_blank">
                    <img src="/IMAGENES/iconSena.png" style="height: 50px; border-radius: 20px" alt="icono sena">
                    
                </a>
                <p class="app-name">SENA DREAM</p>
            </div>
            <div class="app-header-right">
                <button class="mode-switch" title="Switch Theme" id=".mode-switch">
                    <svg class="moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>



                        
                    </svg>
                </button>
                <div class="profile-container">
                    <button class="profile-btn" id="profile-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person" viewBox="0 0 24 24">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zM12 14c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                            
                        </svg>
                        <span>ADMIN</span>
                        <svg id="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                        </svg>
                    </button>
                    <ul class="profile-dropdown" id="profile-dropdown">
                        <li><a href="/index.html">Cerrar Sesión</a></li>
                    </ul>
                    <script>
                        document.getElementById('profile-btn').addEventListener('click', function() {
                            var dropdown = document.getElementById('profile-dropdown');
                            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
                        });
                    </script>
                </div>
            </div>
        </div>
        <!--Aqui es el iconos de navegar-->
        <!--Aqui es el icono de la casa-->
        <div class="app-content">
            <div class="app-sidebar" id="app-sidebar">
                <a href="" class="app-sidebar-link active">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                        <polyline points="9 22 9 12 15 12 15 22" />
                    </svg>
                </a>
                <!--Aqui es el icono de la persona-->
                <a href="/HTML/huesped.html" class="app-sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-person" viewBox="0 0 24 24">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zM12 14c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                </a>
                <!--Aqui es el icono de la habitaciones-->
                <a href="/HTML/habitaciones.html" class="app-sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bed">
                        <path d="M3 7h18v10H3z" />
                        <path d="M3 7v10" />
                        <path d="M21 7v10" />
                        <path d="M3 12h18" />
                        <path d="M7 7v5" />
                        <path d="M17 7v5" />
                    </svg>
                </a>
                <!--Aqui es el icono de la tareas-->
                <a href="/HTML/tareas.html" class="app-sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                        <line x1="16" y1="2" x2="16" y2="6" />
                        <line x1="8" y1="2" x2="8" y2="6" />
                        <line x1="3" y1="10" x2="21" y2="10" />
                    </svg>
                </a>
                <!--Aqui es el icono de la cuenta-->
                <a href="/HTML/cuenta.html" class="app-sidebar-link">
                    <svg class="link-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="feather feather-file-text" viewBox="0 0 24 24">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                        <polyline points="14 2 14 8 20 8" />
                        <line x1="16" y1="13" x2="8" y2="13" />
                        <line x1="16" y1="17" x2="8" y2="17" />
                        <polyline points="10 9 9 9 8 9" />
                    </svg>
                </a>
                <!-- aqui es el icono de los aprendices con su horario de entrada y salida -->
                <a href="/HTML/administrador.html" class="app-sidebar-link">
                    <svg class="link-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="feather feather-pie-chart" viewBox="0 0 24 24">
                        <path d="M21.21 15.89A10 10 0 118 2.83M22 12A10 10 0 0012 2v10z" />
                    </svg>
                </a>
            </div>
            <!--Ya empieza todo dentro de los el menu-->
            <div class="projects-section scrollable">
                <div class="projects-section-header" style="margin-bottom: 0px;">
                    <p>BIENVENIDO</p>
                </div>
                <div class="info-cards">
                    <div class="info-card">
                        <h3>Habitaciones Ocupadas</h3>
                        <p id="habitaciones-ocupadas">No hay habitaciones ocupadas.</p>
                    </div>
                    <div class="info-card">
                        <h3>Huéspedes Actuales</h3>
                        <p id="huespedes-actuales">No hay huéspedes en el hotel actualmente.</p>
                    </div>
                </div>
                <button id="reservas-btn" class="reservas-btn">Reservar Habitación</button>

                <!-- Modal de Reservas -->
                <div id="mensajeModal" class="modal">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h2>Reservas</h2>
                        <form id="reservaForm">
                            <label for="numero-habitacion">Número de Habitación:</label>
                            <input type="number" id="numeroHabitacion" name="numeroHabitacion" required>
                            <label for="id-huesped">ID Huésped:</label>
                            <input type="number" id="idHuesped" name="idHuesped" required>
                            <label for="fecha-ingreso">Fecha de Ingreso:</label>
                            <input type="date" id="fechaIngreso" name="fechaIngreso" required>
                            <label for="fecha-salida">Fecha de Salida:</label>
                            <input type="date" id="fechaSalida" name="fechaSalida" required>
                            <label for="abono">Abono:</label>
                            <input type="number" id="abono" name="abono">
                            <button type="submit">Enviar</button>

                            
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


    <script>
        // Obtener el modal
        var modal = document.getElementById("mensajeModal");

        // Obtener el botón que abre el modal
        var btn = document.getElementById("reservas-btn");

        // Obtener el elemento <span> que cierra el modal
        var span = document.getElementsByClassName("close")[0];

        // Cuando el usuario hace clic en el botón, abre el modal
        btn.onclick = function() {
            modal.style.display = "block";
        
        }

        // Cuando el usuario hace clic en <span> (x), cierra el modal
        span.onclick = function() {
            modal.style.display = "none";
        }

        // Cuando el usuario hace clic en cualquier lugar fuera del modal, lo cierra
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }


        // Alternar entre modo oscuro y claro
        document.querySelector('.mode-switch').addEventListener('click', function() {
            console.log('Alternando modo oscuro');
            document.documentElement.classList.toggle('dark-mode');
            document.documentElement.classList.toggle('light-mode');
            localStorage.setItem('darkMode', document.documentElement.classList.contains('dark-mode'));
        });

        // Alternar visibilidad de la barra de navegación
        document.getElementById('navbar-toggle').addEventListener('click', function() {
            var sidebar = document.getElementById('app-sidebar');
            sidebar.classList.toggle('hidden');
            console.log('Formulario enviado');
        });

        // Mantener el modo oscuro al cambiar de vista
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark-mode');
            document.documentElement.classList.remove('light-mode');
        } else {
            document.documentElement.classList.add('light-mode');
            document.documentElement.classList.remove('dark-mode');
        }
        //Esta es la funcion para enviar los datos de la reserva
        document.getElementById('reservaForm').addEventListener('submit', function(event) {
    event.preventDefault();

    const numeroHabitacion = document.getElementById('numeroHabitacion').value;
    const idHuesped = document.getElementById('idHuesped').value;
    const fechaIngreso = document.getElementById('fechaIngreso').value;
    const fechaSalida = document.getElementById('fechaSalida').value;
    const abono = document.getElementById('abono').value || 0;

    Swal.fire({
        title: 'Procesando reserva...',
        text: 'Por favor, espera',
        icon: 'info',
        allowOutsideClick: false,
        showConfirmButton: false,
        didOpen: () => {
            Swal.showLoading();
        }
    });

    const reserva = {
        numeroHabitacion,
        idHuesped,
        fechaIngreso,
        fechaSalida,
        abono
    };

    fetch('/api/reservas', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(reserva)
    })
    .then(response => response.json())
    .then(data => {
        Swal.close(); // Cierra el mensaje de carga

        if (data.success) {
            Swal.fire({
                title: '¡Reserva exitosa!',
                text: 'La reserva se ha realizado correctamente.',
                icon: 'success',
                confirmButtonText: 'Aceptar'
            }).then(() => {
                modal.style.display = 'none';
                location.reload(); // Recarga la página
            });

        } else {
            Swal.fire({
                title: 'Error',
                text: 'No se pudo realizar la reserva: ' + data.message,
                icon: 'error',
                confirmButtonText: 'Cerrar'
            });
        }
    })
    .catch(error => {
        Swal.fire({
            title: 'Error',
            text: 'Hubo un problema al realizar la reserva',
            icon: 'error',
            confirmButtonText: 'Cerrar'
        });
    });
});
    </script>
</body>
</html>